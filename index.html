<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>KLOHE - Valentine's Day Collection</title>

    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üíó</text></svg>">

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Cormorant+Garamond:wght@400;500;600&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        :root {
            --blanco: #FDF8F6; --rosa-nude: #F5E6E0; --rosa-suave: #E8D5D0;
            --rosa-medio: #D4A59A; --rosa-viejo: #B5838D; --rosa-oscuro: #9B6B7F;
            --bordo: #6D435A; --chocolate: #4A3B3A; --negro-suave: #2C2424; --dorado: #C9A87C;
        }
        body { font-family: 'Inter', sans-serif; background-color: var(--blanco); color: var(--negro-suave); line-height: 1.6; overflow-x: hidden; }
        @keyframes shimmer { 0% { background-position: -1000px 0; } 100% { background-position: 1000px 0; } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .skeleton { background: linear-gradient(90deg, var(--rosa-nude) 25%, var(--rosa-suave) 50%, var(--rosa-nude) 75%); background-size: 1000px 100%; animation: shimmer 2s infinite linear; border-radius: 4px; }
        .blur-up { filter: blur(10px); transition: filter 0.3s ease-out, opacity 0.3s ease-out; opacity: 0; }
        .blur-up.loaded { filter: blur(0); opacity: 1; }
        header { background: rgba(253, 248, 246, 0.95); backdrop-filter: blur(10px); padding: 1.2rem 0; position: sticky; top: 0; z-index: 1000; border-bottom: 1px solid var(--rosa-suave); }
        .container { max-width: 1400px; margin: 0 auto; padding: 0 2rem; }
        nav { display: flex; justify-content: space-between; align-items: center; }
        .logo { font-family: 'Playfair Display', serif; font-size: 2.2rem; color: var(--bordo); text-decoration: none; font-weight: 600; letter-spacing: 8px; text-transform: uppercase; position: relative; }
        .logo::after { content: '‚ô•'; position: absolute; top: -5px; right: -20px; font-size: 0.8rem; color: var(--rosa-viejo); animation: heartbeat 2s ease-in-out infinite; }
        @keyframes heartbeat { 0%, 100% { transform: scale(1); opacity: 0.8; } 50% { transform: scale(1.2); opacity: 1; } }
        .nav-right { display: flex; align-items: center; gap: 1.5rem; }
        .lang-btn { background: transparent; border: 1px solid var(--rosa-medio); color: var(--rosa-oscuro); padding: 0.5rem 1rem; border-radius: 20px; cursor: pointer; font-family: 'Inter', sans-serif; font-size: 0.8rem; font-weight: 600; letter-spacing: 1px; transition: all 0.3s ease; min-height: 36px; display: flex; align-items: center; gap: 0.5rem; }
        .lang-btn:hover { border-color: var(--bordo); background: var(--bordo); color: white; transform: scale(1.05); }
        .social-header { display: flex; gap: 0.8rem; align-items: center; margin-right: 0.5rem; }
        .social-btn { width: 44px; height: 44px; border-radius: 50%; border: 1px solid var(--rosa-medio); display: flex; align-items: center; justify-content: center; text-decoration: none; color: var(--rosa-oscuro); font-size: 1rem; transition: all 0.3s ease; background: transparent; }
        .social-btn:hover { background: var(--bordo); color: white; border-color: var(--bordo); transform: translateY(-2px); }
        .menu-toggle { background: none; border: none; cursor: pointer; padding: 0.5rem; display: flex; flex-direction: column; gap: 5px; z-index: 2000; position: relative; width: 44px; height: 44px; align-items: center; justify-content: center; }
        .menu-toggle span { width: 22px; height: 2px; background: var(--bordo); transition: all 0.3s ease; display: block; }
        .menu-toggle.active span:nth-child(1) { transform: rotate(45deg) translate(5px, 5px); }
        .menu-toggle.active span:nth-child(2) { opacity: 0; }
        .menu-toggle.active span:nth-child(3) { transform: rotate(-45deg) translate(5px, -5px); }
        .categories-menu { position: fixed; top: 0; left: -100%; width: 320px; height: 100vh; background: var(--blanco); z-index: 1500; padding: 5rem 2rem 2rem; transition: left 0.4s cubic-bezier(0.4, 0, 0.2, 1); overflow-y: auto; border-right: 2px solid var(--rosa-suave); }
        .categories-menu.active { left: 0; }
        .categories-menu h3 { font-family: 'Playfair Display', serif; color: var(--bordo); margin-bottom: 1.5rem; font-size: 1.2rem; font-weight: 500; letter-spacing: 3px; text-transform: uppercase; border-bottom: 1px solid var(--rosa-suave); padding-bottom: 0.8rem; }
        .category-btn { display: block; width: 100%; padding: 1rem 0; margin-bottom: 0.3rem; background: transparent; border: none; border-bottom: 1px solid var(--rosa-suave); text-align: left; font-family: 'Inter', sans-serif; font-size: 0.85rem; color: var(--rosa-oscuro); cursor: pointer; transition: all 0.3s ease; font-weight: 400; letter-spacing: 1px; text-transform: uppercase; min-height: 44px; }
        .category-btn:hover, .category-btn.active { color: var(--bordo); padding-left: 1rem; border-bottom-color: var(--bordo); }
        .close-menu { position: absolute; top: 1.2rem; right: 1.2rem; background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--bordo); width: 44px; height: 44px; display: flex; align-items: center; justify-content: center; }
        .cart-icon { position: relative; cursor: pointer; font-size: 1.1rem; padding: 0.5rem; transition: all 0.3s ease; width: 44px; height: 44px; display: flex; align-items: center; justify-content: center; border: 1px solid var(--rosa-medio); border-radius: 50%; color: var(--bordo); }
        .cart-icon:hover { background: var(--bordo); color: white; border-color: var(--bordo); }
        .cart-count { position: absolute; top: -5px; right: -5px; background: var(--bordo); color: white; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 0.7rem; font-weight: 600; }
        .hero { background: linear-gradient(135deg, var(--blanco) 0%, var(--rosa-nude) 100%); padding: 3rem 0; text-align: center; position: relative; border-bottom: 1px solid var(--rosa-suave); overflow: hidden; }
        .hero h1 { font-family: 'Playfair Display', serif; font-size: 2.2rem; color: var(--bordo); margin-bottom: 0.5rem; font-weight: 400; letter-spacing: 4px; text-transform: uppercase; }
        .hero p { font-size: 0.9rem; color: var(--rosa-oscuro); font-weight: 300; letter-spacing: 2px; font-style: italic; margin-bottom: 1.5rem; }
        .daily-verse-container { background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(5px); border: 1px solid var(--rosa-medio); border-radius: 12px; padding: 1.5rem 2rem; margin: 0 auto 2rem; max-width: 700px; position: relative; animation: fadeIn 1s ease-in; }
        .verse-text { font-family: 'Cormorant Garamond', serif; font-size: 1.1rem; color: var(--chocolate); line-height: 1.6; font-style: italic; margin-bottom: 0.5rem; }
        .verse-reference { font-size: 0.8rem; color: var(--bordo); font-weight: 600; letter-spacing: 1px; }
        .search-container { max-width: 600px; margin: 0 auto; position: relative; }
        .search-input { width: 100%; padding: 1rem 1.5rem; padding-left: 3rem; border: 1px solid var(--rosa-medio); background: rgba(255,255,255,0.8); font-family: 'Inter', sans-serif; font-size: 0.9rem; transition: all 0.3s ease; border-radius: 30px; min-height: 44px; }
        .search-input:focus { outline: none; border-color: var(--bordo); box-shadow: 0 0 0 3px rgba(157, 107, 127, 0.1); }
        .search-icon { position: absolute; left: 1.2rem; top: 50%; transform: translateY(-50%); color: var(--rosa-oscuro); }
        .products { padding: 3rem 0; background: var(--blanco); min-height: 50vh; }
        .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2.5rem; padding-bottom: 1rem; border-bottom: 1px solid var(--rosa-suave); }
        .section-title { font-family: 'Playfair Display', serif; font-size: 1.6rem; color: var(--bordo); font-weight: 500; letter-spacing: 3px; text-transform: uppercase; }
        .products-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 2rem; }
        .product-card { background: var(--blanco); overflow: hidden; transition: all 0.4s ease; position: relative; display: flex; flex-direction: column; border: 1px solid var(--rosa-suave); border-radius: 4px; animation: fadeIn 0.5s ease forwards; }
        .product-card:hover { transform: translateY(-8px); box-shadow: 0 15px 40px rgba(157, 107, 127, 0.15); border-color: var(--rosa-medio); }
        .product-image-container { position: relative; width: 100%; aspect-ratio: 1/1; background: var(--rosa-nude); overflow: hidden; cursor: pointer; }
        .product-image { width: 100%; height: 100%; object-fit: cover; transition: transform 0.6s ease; }
        .product-card:hover .product-image.loaded { transform: scale(1.05); }
        .stock-badge { position: absolute; top: 0.8rem; right: 0.8rem; background: rgba(255,255,255,0.95); color: var(--bordo); padding: 0.3rem 0.8rem; font-size: 0.7rem; font-weight: 500; letter-spacing: 1px; text-transform: uppercase; border: 1px solid var(--rosa-medio); border-radius: 20px; z-index: 2; }
        .product-info { padding: 1.2rem; flex-grow: 1; display: flex; flex-direction: column; border-top: 1px solid var(--rosa-suave); }
        .product-name { font-family: 'Playfair Display', serif; font-size: 1.1rem; color: var(--negro-suave); margin-bottom: 0.3rem; text-transform: capitalize; line-height: 1.3; font-weight: 500; letter-spacing: 0.5px; }
        .product-barcode { font-size: 0.75rem; color: var(--rosa-oscuro); margin-bottom: 0.8rem; font-family: 'Courier New', monospace; letter-spacing: 1px; }
        .product-description { font-size: 0.85rem; color: var(--rosa-oscuro); line-height: 1.5; margin-bottom: 0.8rem; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
        .product-row { display: flex; justify-content: space-between; align-items: center; margin-top: auto; margin-bottom: 0.8rem; padding-top: 0.8rem; border-top: 1px solid var(--rosa-suave); }
        .product-price { font-size: 1.2rem; color: var(--bordo); font-weight: 600; letter-spacing: 1px; }
        .eye-btn { width: 44px; height: 44px; border-radius: 50%; border: 1px solid var(--rosa-medio); background: transparent; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 1rem; transition: all 0.3s ease; color: var(--rosa-oscuro); }
        .eye-btn:hover { background: var(--bordo); color: white; border-color: var(--bordo); }
        .btn-add-cart { width: 100%; padding: 0.9rem; background: var(--bordo); color: white; border: none; cursor: pointer; font-weight: 500; transition: all 0.3s ease; font-family: 'Inter', sans-serif; font-size: 0.75rem; text-transform: uppercase; letter-spacing: 1.5px; border-radius: 0 0 4px 4px; min-height: 44px; }
        .btn-add-cart:hover { background: var(--rosa-viejo); }
        .btn-add-cart:disabled { background: var(--rosa-suave); color: var(--rosa-oscuro); cursor: not-allowed; }
        .whatsapp-float { position: fixed; bottom: 30px; left: 30px; width: 60px; height: 60px; background: var(--bordo); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.8rem; cursor: pointer; z-index: 9999; box-shadow: 0 4px 12px rgba(157, 107, 127, 0.4); transition: all 0.5s ease; text-decoration: none; opacity: 1; transform: scale(1); }
        .whatsapp-float:hover { transform: scale(1.1); box-shadow: 0 6px 20px rgba(157, 107, 127, 0.6); background: var(--rosa-viejo); }
        .whatsapp-tooltip { position: absolute; left: 70px; background: var(--bordo); color: white; padding: 0.5rem 1rem; border-radius: 4px; font-size: 0.8rem; white-space: nowrap; opacity: 0; visibility: hidden; transition: opacity 0.5s ease, visibility 0.5s ease, left 0.3s ease; letter-spacing: 0.5px; pointer-events: none; }
        .whatsapp-tooltip::before { content: ''; position: absolute; left: -6px; top: 50%; transform: translateY(-50%); border-width: 6px 6px 6px 0; border-style: solid; border-color: transparent var(--bordo) transparent transparent; }
        .whatsapp-tooltip.show-auto { opacity: 1; visibility: visible; left: 75px; }
        .whatsapp-float:hover .whatsapp-tooltip { opacity: 1; visibility: visible; left: 75px; }
        .cart-modal { display: none; position: fixed; top: 0; right: -100%; width: 420px; height: 100%; background: var(--blanco); z-index: 2000; padding: 2rem; overflow-y: auto; transition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1); border-left: 2px solid var(--rosa-suave); }
        .cart-modal.active { display: block; right: 0; }
        .cart-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; padding-bottom: 1rem; border-bottom: 1px solid var(--rosa-suave); }
        .cart-header h2 { font-family: 'Playfair Display', serif; color: var(--bordo); font-size: 1.5rem; font-weight: 500; letter-spacing: 2px; text-transform: uppercase; }
        .close-cart { background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--bordo); width: 44px; height: 44px; display: flex; align-items: center; justify-content: center; }
        .cart-item { display: flex; gap: 1rem; margin-bottom: 1.2rem; padding-bottom: 1.2rem; border-bottom: 1px solid var(--rosa-suave); align-items: center; }
        .cart-item-image { width: 70px; height: 70px; background: var(--rosa-nude); overflow: hidden; flex-shrink: 0; border: 1px solid var(--rosa-suave); border-radius: 4px; }
        .cart-item-image img { width: 100%; height: 100%; object-fit: cover; }
        .cart-item-details { flex-grow: 1; }
        .cart-item-details h4 { font-family: 'Playfair Display', serif; color: var(--bordo); margin-bottom: 0.2rem; font-size: 1rem; font-weight: 500; letter-spacing: 0.5px; }
        .cart-empty { text-align: center; color: var(--rosa-oscuro); padding: 3rem 0; font-style: italic; }
        .cart-total { margin-top: 1rem; padding-top: 1rem; border-top: 2px solid var(--bordo); font-size: 1.2rem; font-weight: 600; color: var(--bordo); display: flex; justify-content: space-between; margin-bottom: 1.5rem; letter-spacing: 1px; }
        .btn-whatsapp { width: 100%; padding: 1.1rem; background: var(--bordo); color: white; border: none; cursor: pointer; font-weight: 500; transition: all 0.3s ease; font-family: 'Inter', sans-serif; font-size: 0.8rem; display: flex; align-items: center; justify-content: center; gap: 0.5rem; text-decoration: none; text-transform: uppercase; letter-spacing: 2px; border-radius: 30px; min-height: 44px; }
        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(44, 36, 36, 0.4); z-index: 1500; backdrop-filter: blur(2px); }
        .overlay.active { display: block; }
        .notification { position: fixed; bottom: 20px; right: 20px; background: var(--bordo); color: white; padding: 1rem 2rem; z-index: 4000; transform: translateY(100px); opacity: 0; transition: all 0.4s ease; font-size: 0.85rem; font-weight: 500; letter-spacing: 1px; text-transform: uppercase; border-left: 3px solid var(--dorado); border-radius: 4px; }
        .notification.show { transform: translateY(0); opacity: 1; }
        @media (max-width: 1200px) { .products-grid { grid-template-columns: repeat(3, 1fr); } }
        @media (max-width: 768px) { .products-grid { grid-template-columns: repeat(2, 1fr); gap: 1rem; } .whatsapp-float { width: 56px; height: 56px; font-size: 1.5rem; bottom: 20px; left: 20px; } }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <nav>
                <a href="#" class="logo">KLOHE</a>
                <div class="nav-right">
                    <div class="language-switcher">
                        <button class="lang-btn" onclick="toggleLanguage()" id="langBtn">
                            <i class="fas fa-globe"></i> <span id="currentLang">ES</span>
                        </button>
                    </div>
                    <div class="social-header">
                        <a href="https://instagram.com/klohesv" target="_blank" class="social-btn"><i class="fab fa-instagram"></i></a>
                        <a href="https://tiktok.com/@klohesv" target="_blank" class="social-btn"><i class="fab fa-tiktok"></i></a>
                        <a href="https://facebook.com/klohejewelry" target="_blank" class="social-btn"><i class="fab fa-facebook-f"></i></a>
                    </div>
                    <button class="menu-toggle" id="menuBtn"><span></span><span></span><span></span></button>
                    <div class="cart-icon" onclick="toggleCart()"><i class="fas fa-shopping-bag"></i><span class="cart-count" id="cartBadge" style="display: none;">0</span></div>
                </div>
            </nav>
        </div>
    </header>

    <div class="menu-overlay" id="menuOverlay"></div>
    <div class="categories-menu" id="categoriesMenu">
        <button class="close-menu" onclick="toggleMenu()"><i class="fas fa-times"></i></button>
        <h3>Categor√≠as</h3>
        <button class="category-btn active" onclick="filterProducts('todos', this)">Todas</button>
        <button class="category-btn" onclick="filterProducts('anillo', this)">Anillos</button>
        <button class="category-btn" onclick="filterProducts('aritos', this)">Aritos</button>
        <button class="category-btn" onclick="filterProducts('collar', this)">Collares</button>
        <button class="category-btn" onclick="filterProducts('pulsera', this)">Pulseras</button>
        <button class="category-btn" onclick="filterProducts('reloj', this)">Relojes</button>
    </div>

    <section class="hero">
        <div class="container">
            <div class="hero-content">
                <h1>Colecci√≥n San Valent√≠n</h1>
                <p>Regalos que hablan desde el coraz√≥n</p>
                <div class="daily-verse-container">
                    <div class="verse-text" id="verseText"></div>
                    <div class="verse-reference" id="verseReference"></div>
                </div>
                <div class="search-container">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" class="search-input" id="searchInput" placeholder="Buscar el regalo perfecto...">
                </div>
            </div>
        </div>
    </section>

    <section class="products">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title" id="categoryTitle">Todas</h2>
            </div>
            <div class="products-grid" id="productsContainer"></div>
        </div>
    </section>

    <a href="https://wa.me/50366711569" target="_blank" class="whatsapp-float" id="whatsappFloat">
        <i class="fab fa-whatsapp"></i>
        <span class="whatsapp-tooltip" id="whatsappTooltip">¬øNecesitas ayuda?</span>
    </a>

    <div class="overlay" id="overlay" onclick="toggleCart()"></div>
    <div class="cart-modal" id="cartModal">
        <div class="cart-header">
            <h2>Tu Carrito</h2>
            <button class="close-cart" onclick="toggleCart()"><i class="fas fa-times"></i></button>
        </div>
        <div id="cartItems"><div class="cart-empty">Tu carrito est√° vac√≠o</div></div>
        <div class="cart-total"><span>Total:</span><span id="cartTotal">$0.00</span></div>
        <a href="#" class="btn-whatsapp" id="whatsappBtn" target="_blank"><i class="fab fa-whatsapp"></i> Comprar por WhatsApp</a>
    </div>

    <div class="notification" id="notification">Producto agregado</div>

    <script>

        // Vers√≠culos diarios
        const dailyVerses = [
            { text: "El amor es paciente, es bondadoso. El amor no es envidioso ni jactancioso ni orgulloso.", reference: "1 Corintios 13:4" },
            { text: "Porque de tal manera am√≥ Dios al mundo, que ha dado a su Hijo unig√©nito.", reference: "Juan 3:16" },
            { text: "El Se√±or es mi pastor, nada me faltar√°.", reference: "Salmo 23:1" },
            { text: "Todo lo puedo en Cristo que me fortalece.", reference: "Filipenses 4:13" },
            { text: "Conf√≠a en el Se√±or de todo coraz√≥n.", reference: "Proverbios 3:5" }
        ];

        // Estado
        const AppState = {
            currentFilter: 'todos',
            cart: JSON.parse(localStorage.getItem('klohe_cart')) || [],
            currentPage: 0,
            filteredProducts: [],
            isLoading: false,
            hasMoreProducts: true
        };

        // Mostrar vers√≠culo del d√≠a
        function displayDailyVerse() {
            const today = new Date();
            const verseIndex = (today.getDate() - 1) % dailyVerses.length;
            const verse = dailyVerses[verseIndex];
            document.getElementById('verseText').textContent = verse.text;
            document.getElementById('verseReference').textContent = `‚Äî ${verse.reference}`;
        }

        /**
         * Funci√≥n para controlar la visibilidad del √≠cono de WhatsApp
         * El √≠cono desaparece despu√©s de 10 segundos y reaparece despu√©s de 3 minutos
         * Ciclo: visible 10s ‚Üí oculto 3 min ‚Üí visible 10s ‚Üí oculto 3 min...
         */
        function initWhatsAppCycle() {
            const float = document.getElementById('whatsappFloat');
            const tooltip = document.getElementById('whatsappTooltip');

            // Funci√≥n para ocultar el √≠cono con animaci√≥n suave
            function hideWhatsAppIcon() {
                float.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                float.style.opacity = '0';
                float.style.transform = 'scale(0)';
                float.style.pointerEvents = 'none';
                tooltip.classList.remove('show-auto');
            }

            // Funci√≥n para mostrar el √≠cono con animaci√≥n suave
            function showWhatsAppIcon() {
                float.style.opacity = '1';
                float.style.transform = 'scale(1)';
                float.style.pointerEvents = 'auto';
                tooltip.classList.add('show-auto');
                setTimeout(() => tooltip.classList.remove('show-auto'), 4000);
            }

            // Funci√≥n principal del ciclo
            function startWhatsAppCycle() {
                showWhatsAppIcon();

                // Despu√©s de 10 segundos, ocultar el √≠cono
                setTimeout(() => {
                    hideWhatsAppIcon();

                    // Despu√©s de 3 minutos (180 segundos), mostrar nuevamente
                    setTimeout(() => {
                        showWhatsAppIcon();
                        // Reiniciar el ciclo
                        setTimeout(() => {
                            hideWhatsAppIcon();
                            // Continuar ciclo infinito
                            setInterval(() => {
                                showWhatsAppIcon();
                                setTimeout(hideWhatsAppIcon, 10000);
                            }, 190000); // 3 min + 10 seg = 190 seg
                        }, 10000);
                    }, 180000); // 3 minutos = 180,000 ms
                }, 10000); // 10 segundos = 10,000 ms
            }

            startWhatsAppCycle();
        }

        // Toggle men√∫
        function toggleMenu() {
            const menu = document.getElementById('categoriesMenu');
            const overlay = document.getElementById('menuOverlay');
            const btn = document.getElementById('menuBtn');
            const isActive = menu.classList.contains('active');

            if (isActive) {
                menu.classList.remove('active');
                overlay.classList.remove('active');
                btn.classList.remove('active');
                document.body.style.overflow = '';
            } else {
                menu.classList.add('active');
                overlay.classList.add('active');
                btn.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        }

        // Toggle carrito
        function toggleCart() {
            const modal = document.getElementById('cartModal');
            const overlay = document.getElementById('overlay');
            const isActive = modal.classList.contains('active');

            if (isActive) {
                modal.classList.remove('active');
                overlay.classList.remove('active');
                document.body.style.overflow = '';
            } else {
                modal.classList.add('active');
                overlay.classList.add('active');
                document.body.style.overflow = 'hidden';
                updateCart();
            }
        }

        // Filtrar productos
        function filterProducts(category, btnElement) {
            AppState.currentFilter = category;
            AppState.currentPage = 0;

            document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
            if (btnElement) btnElement.classList.add('active');

            document.getElementById('categoryTitle').textContent = category === 'todos' ? 'Todas' : btnElement.textContent;

            if (typeof products !== 'undefined') {
                if (category === 'todos') {
                    AppState.filteredProducts = [...products];
                } else {
                    const categoryMap = { 'anillo': 'Anillos', 'aritos': 'Aritos', 'collar': 'Collares', 'pulsera': 'Pulseras', 'reloj': 'Relojes' };
                    AppState.filteredProducts = products.filter(p => p.category === categoryMap[category]);
                }
                renderProducts();
            }
            toggleMenu();
        }

        // Renderizar productos
        function renderProducts() {
            const container = document.getElementById('productsContainer');
            container.innerHTML = '';

            AppState.filteredProducts.forEach((product, index) => {
                const card = createProductCard(product, index);
                container.appendChild(card);
            });
        }

        // Crear tarjeta de producto
        function createProductCard(product, index) {
            const card = document.createElement('div');
            card.className = 'product-card';
            card.style.animationDelay = `${index * 0.05}s`;

            const hasStock = product.stock > 0;

            card.innerHTML = `
                <div class="product-image-container">
                    <img src="${product.barcode}.jpg" alt="${product.name}" class="product-image blur-up" loading="lazy"
                         onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22400%22 height=%22400%22%3E%3Crect width=%22400%22 height=%22400%22 fill=%22%23F5E6E0%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 font-size=%2260%22 fill=%22%236D435A%22 text-anchor=%22middle%22 dy=%22.3em%22%3E${product.name.charAt(0)}%3C/text%3E%3C/svg%3E'; this.classList.add('loaded');">
                    <span class="stock-badge">${product.stock} disp.</span>
                </div>
                <div class="product-info">
                    <h3 class="product-name">${product.name}</h3>
                    <p class="product-barcode">COD: ${product.barcode}</p>
                    <p class="product-description">${product.description || ''}</p>
                    <div class="product-row">
                        <span class="product-price">$${product.price.toFixed(2)}</span>
                    </div>
                    <button class="btn-add-cart" onclick="addToCart(${index})" ${!hasStock ? 'disabled' : ''}>
                        ${hasStock ? 'Agregar al carrito' : 'Agotado'}
                    </button>
                </div>
            `;

            return card;
        }

        // Agregar al carrito
        function addToCart(index) {
            const product = AppState.filteredProducts[index];
            if (product.stock <= 0) return;

            const existingItem = AppState.cart.find(item => item.barcode === product.barcode);

            if (existingItem) {
                if (existingItem.quantity < product.stock) {
                    existingItem.quantity++;
                } else {
                    return;
                }
            } else {
                AppState.cart.push({ ...product, quantity: 1 });
            }

            updateCart();
            showNotification('Producto agregado');
        }

        // Eliminar del carrito
        function removeFromCart(barcode) {
            AppState.cart = AppState.cart.filter(item => item.barcode !== barcode);
            updateCart();
        }

        // Actualizar carrito
        function updateCart() {
            const cartItems = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');
            const cartBadge = document.getElementById('cartBadge');
            const whatsappBtn = document.getElementById('whatsappBtn');

            localStorage.setItem('klohe_cart', JSON.stringify(AppState.cart));

            const totalItems = AppState.cart.reduce((sum, item) => sum + item.quantity, 0);
            cartBadge.textContent = totalItems;
            cartBadge.style.display = totalItems > 0 ? 'flex' : 'none';

            if (AppState.cart.length === 0) {
                cartItems.innerHTML = '<div class="cart-empty">Tu carrito est√° vac√≠o</div>';
                document.getElementById('cartTotal').textContent = '$0.00';
                return;
            }

            cartItems.innerHTML = '';
            let total = 0;

            AppState.cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;

                cartItems.innerHTML += `
                    <div class="cart-item">
                        <div class="cart-item-image">
                            <img src="${item.barcode}.jpg" alt="${item.name}" loading="lazy">
                        </div>
                        <div class="cart-item-details">
                            <h4>${item.name}</h4>
                            <p>$${item.price.toFixed(2)} x ${item.quantity}</p>
                        </div>
                        <button class="close-cart" onclick="removeFromCart('${item.barcode}')" style="position:static;width:auto;height:auto;"><i class="fas fa-trash"></i></button>
                    </div>
                `;
            });

            cartTotal.textContent = `$${total.toFixed(2)}`;

            const message = AppState.cart.map(item => `‚Ä¢ ${item.name} (COD: ${item.barcode}) - Cant: ${item.quantity}`).join('%0A');
            whatsappBtn.href = `https://wa.me/50366711569?text=¬°Hola! Quiero comprar:%0A%0A${message}%0A%0ATotal: $${total.toFixed(2)}`;
        }

        // Mostrar notificaci√≥n
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            setTimeout(() => notification.classList.remove('show'), 2500);
        }

        // Cambiar idioma
        function toggleLanguage() {
            const btn = document.getElementById('currentLang');
            btn.textContent = btn.textContent === 'ES' ? 'EN' : 'ES';
        }

        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            displayDailyVerse();
            initWhatsAppCycle();

            if (typeof products !== 'undefined') {
                AppState.filteredProducts = [...products];
                renderProducts();
                updateCart();
            }

            document.getElementById('menuOverlay').addEventListener('click', toggleMenu);
        });
    </script>
    <script src="products.js"></script>
</body>
</html>
